<div *ngIf="test">
    <div class="container">
        <div *ngIf="remarkAnswer" [ngClass]="{fade: !remarkAnswer}" class="alert alert-success alert-dismissible">
            <strong>Success!</strong> {{remarkAnswer}}
        </div>

        <div *ngIf="!results" class="row">
            <h3 class="col-sm-9">{{test.nameTest}}</h3>
            <button mat-raised-button (click)="showReport()" class="btn btn-danger btn-md col-sm-1 w-100 h-100">Report
            </button>
        </div>

        <div *ngIf="isQuestions" class="row">
            <div class="card  border shadow p-3  bg-white rounded col" style="width: 180rem;">
                <p>
                    <ngb-progressbar type="success" [value]="questionId" [max]="test.questions.length-1"></ngb-progressbar>
                </p>
                <span>{{questionId + 1}} of {{test.questions.length}}</span>

                <!--<img class="card-img-top " href="" height="50px" width="100px"  alt="Card image cap">-->
                <div *ngIf="test.questions[questionId].typeQuestion == 'ONE_ANSWER'" class="card-body">
                    <h4 class="card-title">{{test.questions[questionId].textQuestion}}</h4>
                    <mat-radio-group [(ngModel)]="selectedAnswer">
                        <div class="form-check mb-2" *ngFor="let answer of test.questions[questionId].answers">
                            <mat-radio-button [value]="answer" color="primary"> {{answer.textAnswer}} </mat-radio-button>
                        </div>
                    </mat-radio-group>
                </div>


                <div *ngIf="test.questions[questionId].typeQuestion == 'MULTIPLE_ANSWER'" class="card-body">
                    <h4 class="card-title">{{test.questions[questionId].textQuestion}}</h4>


                    <mat-selection-list #answersCheck [(ngModel)]="answers">
                        <mat-list-option checkboxPosition="before" color="primary" *ngFor="let answer of test.questions[questionId].answers;
                         let i = index" [value]="answer">
                            {{answer.textAnswer}}
                        </mat-list-option>
                    </mat-selection-list>
                </div>

                <div *ngIf="test.questions[questionId].typeQuestion == 'OPEN'" class="card-body">
                    <h4 class="card-title">{{test.questions[questionId].textQuestion}}</h4>
                    <mat-form-field required="true" class="form-check mb-2" minlength="10" maxlength="200">
                        <textarea [(ngModel)]="openAnswer" matInput placeholder="Enter your answer"></textarea>
                    </mat-form-field>
                </div>
            </div>

            <!--<div *ngIf="isTestNeedExpert"><h1>{{isTestNeedExpert}}</h1></div>-->


        </div>


    </div>


    <div *ngIf="results && isTestNeedExpert">
        Wait until expert check...
    </div>


    <div style="margin-top: 8px" class="row">
        <div *ngIf="!isFirst" class="col-sm-1">
            <button (click)="decrementIndex()" class="btn btn-secondary btn-lg">
                <i class="glyphicon glyphicon-arrow-left"></i>
            </button>
        </div>

        <div *ngIf="buttonType == 1" class="col-sm-1">
            <button [disabled]="selectedAnswer == undefined && openAnswer == null && answers.length == 0" (click)="incrementIndex()" class="btn btn-primary btn-lg">
                <i *ngIf="answers != undefined " class="glyphicon glyphicon-arrow-right"></i>
                <i *ngIf="answers == undefined" matTooltip="Choose at least one answer!" class="glyphicon glyphicon-arrow-right"></i>
            </button>
        </div>

        <div *ngIf="buttonType == 2" class="col">
            <button (click)="testEnd()" class="btn btn-success btn-lg">Finish test</button>
        </div>

        <div *ngIf="buttonType == 3" class="row">
            <button [routerLink]="['/group/' + test.groupId]" class="btn btn-info btn-lg">
                <i class="glyphicon glyphicon-home"></i></button>
        </div>


    </div>
</div>

<div *ngIf="!test" #testLoading>
    <mat-spinner class="mt-4 center-block"></mat-spinner>
</div>


<div *ngIf="results && !isTestNeedExpert">
    <h2 class="row">Your answers</h2>
    <div>

        <div *ngFor="let result of results; let i = index">
            <mat-expansion-panel class="row" (opened)="panelOpenState = true"
                                 (closed)="panelOpenState = false"
                                 *ngFor="let value of results[i].replies | keyvalue">
                <mat-expansion-panel-header>
                    <mat-panel-title>
                        {{value.key  }}
                    </mat-panel-title>
                    <mat-panel-description style="flex: 0 0 auto;">
                        {{value.value + '' | slice:0:10}}...
                    </mat-panel-description>
                </mat-expansion-panel-header>
                <p><strong>{{value.value}}</strong></p>
            </mat-expansion-panel>


        </div>

    </div>

</div>
